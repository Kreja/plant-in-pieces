extends layout.jade
block title
  title 植物碎片

block content
  template(is="auto-binding")
    core-toolbar.toolbar
      core-icon(icon="{{$.pages.selected != 0 ? 'arrow-back' : 'menu'}}", on-tap="{{back}}")
      div(flex="") Stuff
      core-icon-button(icon="more-vert")
    core-animated-pages#pages(flex="", selected="0", on-core-animated-pages-transition-end="{{transitionend}}", transitions="hero-transition")
      section(vertical="", layout="")
        #noscroll(fit="", hero-p="")
          #container(flex="", horizontal="", wrap="", around-justified="", layout="", cross-fade="")
            template(repeat="{{item in items}}")
              .card(vertical="", center="", center-justified="", layout="", hero-id="item-{{item}}", hero?="{{$.pages.selected === item + 1 || lastSelected === item + 1}}", on-tap="{{selectView}}")
                span(cross-fade="") {{item}}
            div(style="width: 500px;height: 500px;")
              pi-plants(cross-fade,raised,plantsclass="boleshu")
      template(repeat="{{item in items}}")
        section(vertical="", layout="")
          .view(flex="", vertical="", center="", center-justified="", layout="", hero-id="item-{{item}}", hero?="{{$.pages.selected === item + 1 || $.pages.selected === 0}}")
            div(style="width: 500px;height: 500px;")
              pi-plants(cross-fade,raised,plantsclass="baohuayulan")
            span(cross-fade="") {{item}}




block beforebody
  script(src='/scripts/app.js')
  script.
    addEventListener('template-bound', function(e) {
      var scope = e.target;
      var items = [], count=50;
      for (var i=0; i < count; i++) {
        items.push(i);
      }

      scope.items = items;

      scope.selectView = function(e) {
        var i = e.target.templateInstance.model.item;
        this.$.pages.selected = i+1;
      }

      scope.back = function() {
        this.lastSelected = this.$.pages.selected;
        console.log(this.lastSelected);
        this.$.pages.selected = 0;
      }

      scope.transitionend = function() {
        if (this.lastSelected) {
          this.lastSelected = null;
        }
      }
    })

